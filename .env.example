APP_ENV=dev
APP_VERSION=dev
APP_HTTP_PORT=8080

# Оставьте пустым по умолчанию; для локального прокси dev-сервера вне Docker можно указать http://localhost:5173
MINIAPP_DEV_SERVER_URL=
# Оставьте пустым по умолчанию; для статической выдачи локально после npm run build можно указать miniapp/dist
MINIAPP_STATIC_DIR=

# Mini App / Auth
# Секрет для подписи session token Mini App. В проде обязательно заменить.
API_SESSION_JWT_SECRET=please-change-me
# TTL гостевого session token (секунды). Управляет сроком действия Bearer.
API_SESSION_TTL_SECONDS=3600

# Безопасность Telegram Mini App initData:
# - отклонять initData старше этого значения (секунды)
TELEGRAM_MINIAPP_INITDATA_MAX_AGE_SECONDS=300
# - отклонять initData слишком далеко в будущем относительно часов сервера (секунды)
TELEGRAM_MINIAPP_INITDATA_MAX_FUTURE_SKEW_SECONDS=30

TELEGRAM_BOT_ENABLED=false
# TELEGRAM_BOT_TOKEN нужен и для Mini App auth: подпись initData валидируется на основе bot token.
# Не добавляйте реальные токены/секреты в репозиторий.
TELEGRAM_BOT_TOKEN=
TELEGRAM_BOT_MODE=long_polling
TELEGRAM_WEBHOOK_PATH=/telegram/webhook
TELEGRAM_WEBHOOK_SECRET_TOKEN=
TELEGRAM_WEBAPP_PUBLIC_URL=http://localhost:8080/miniapp/
PLATFORM_OWNER_TELEGRAM_ID=
PLATFORM_OWNER_USER_ID=
TELEGRAM_LONG_POLLING_TIMEOUT_SECONDS=25
TELEGRAM_STAFF_CHAT_LINK_TTL_SECONDS=900
# Используйте уникальную строку, не совпадающую с токенами; требуется для HMAC кода привязки (обязательно при TELEGRAM_BOT_ENABLED=true)
TELEGRAM_STAFF_CHAT_LINK_SECRET_PEPPER=please-set-when-enabled
TELEGRAM_REQUIRE_STAFF_CHAT_ADMIN=true
# Outbox для исходящих Telegram-сообщений
TELEGRAM_OUTBOX_POLL_INTERVAL_MS=500
TELEGRAM_OUTBOX_BATCH_SIZE=25
TELEGRAM_OUTBOX_VISIBILITY_TIMEOUT_SECONDS=30
TELEGRAM_OUTBOX_MAX_ATTEMPTS=10
TELEGRAM_OUTBOX_MAX_CONCURRENCY=4
TELEGRAM_OUTBOX_PER_CHAT_MIN_INTERVAL_MS=1000
TELEGRAM_OUTBOX_MIN_BACKOFF_SECONDS=1
TELEGRAM_OUTBOX_MAX_BACKOFF_SECONDS=60

# Ограничение гостевых endpoint от спама
GUEST_RATE_LIMIT_STAFF_CALL_MAX_REQUESTS=5
GUEST_RATE_LIMIT_STAFF_CALL_WINDOW_SECONDS=30
GUEST_RATE_LIMIT_ADD_BATCH_MAX_REQUESTS=5
GUEST_RATE_LIMIT_ADD_BATCH_WINDOW_SECONDS=10

# Инвайты персонала (staff invite codes)
# TTL инвайта в секундах (по умолчанию 7 дней).
VENUE_STAFF_INVITE_TTL_SECONDS=604800
# Максимальная длительность, если передан expiresIn (по умолчанию 30 дней).
VENUE_STAFF_INVITE_MAX_TTL_SECONDS=2592000
# Секрет для HMAC инвайтов (обязательно в проде).
VENUE_STAFF_INVITE_SECRET_PEPPER=please-set-when-enabled

# Подписки и биллинг
BILLING_PROVIDER=fake
BILLING_WEBHOOK_SECRET=
# Опциональный allowlist IP/CIDR для billing webhook (через запятую)
BILLING_WEBHOOK_IP_ALLOWLIST=
# Разрешать X-Forwarded-For для определения IP клиента billing webhook (по умолчанию false); включайте только за доверенным прокси/ингрессом, который очищает X-Forwarded-For
BILLING_WEBHOOK_IP_ALLOWLIST_USE_X_FORWARDED_FOR=false
# Таймзона биллинга (например UTC или Europe/Moscow)
BILLING_SUBSCRIPTION_TIME_ZONE=UTC
# За сколько дней до начала периода создавать инвойс
BILLING_SUBSCRIPTION_LEAD_DAYS=7
# За сколько дней до dueAt отправлять напоминание
BILLING_SUBSCRIPTION_REMINDER_DAYS=3
# Интервал запуска job (секунды)
BILLING_SUBSCRIPTION_INTERVAL_SECONDS=60

DB_JDBC_URL=jdbc:postgresql://localhost:5432/hookah
DB_USER=hookah
DB_PASSWORD=hookah

POSTGRES_USER=hookah
POSTGRES_PASSWORD=hookah
POSTGRES_DB=hookah
